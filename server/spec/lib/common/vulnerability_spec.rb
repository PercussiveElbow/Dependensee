# spec/lib/common/vulnerability.rb
require 'rails_helper'
require_relative '../../../app/lib/common/vulnerability'


RSpec.describe Vulnerability do

  before(:each) do
    @cve = RubyCve::new(:dependency_name => 'name', :cve_id => '2017-123', :date => '', :desc => '', :cvss2 =>'8', :unaffected_versions =>[].to_a, :patched_versions => '1.2.3')
    @a_vuln = Vulnerability.new('1.2.3', '4.5.6' , @cve)
  end

  it 'should be not be an empty cve' do
    expect(@a_vuln.cve).to eql(@cve)
  end

  it 'should have same version' do
    expect(@a_vuln.our_version).to eql('1.2.3')
  end

  it 'should have same patched version' do
    expect(@a_vuln.patched_version).to eql('4.5.6')
  end

end

