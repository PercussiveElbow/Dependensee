# spec/lib/common/vulnerability.rb
require 'rails_helper'
require_relative '../../../app/lib/common/vulnerability'


RSpec.describe Vulnerability do

  before(:each) do
    @cve = RubyCve::new(:dependency_name => 'name', :cve_id => '2017-123', :date => '', :desc => '', :cvss2 =>'8', :unaffected_versions =>[].to_a, :patched_versions => '1.2.3')
    @aVuln = Vulnerability.new('1.2.3','4.5.6' , @cve)
  end

  it 'should be not be an empty cve' do
    expect( @aVuln.cve).to eql(@cve)
  end

  it 'should have same version' do
    expect( @aVuln.our_version).to eql('1.2.3')
  end

  it 'should have same patched version' do
    expect( @aVuln.patched_version).to eql('4.5.6')
  end

end

