class ExploitController < ApplicationController
  before_action :cve_or_edb, only: [:show]
  skip_before_action :auth_req

  # GET /cve/:cve_id
  def show
    json_response(:edb_id => @exploit)
  end

  def cve_or_edb
    params[:id].include? "-" ? find_exploit_by_cve : find_cve_by_edb_id
  end

  def find_exploit_by_cve
    @exploit = Exploit.where(" '#{params[:id]}' = ANY (cves)").first.edb_id.to_s #todo sanitize
  end

  def find_cve_by_edb_id
    @exploit = Exploit.where(['edb_id = ?', params[:id]]).first.edb_id.to_s
  end

end
